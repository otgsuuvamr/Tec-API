- Melhorias Futuras
Criar tratamento global de erros.

Criar logs para auditoria de alteraÃ§Ãµes/exclusÃµes de usuÃ¡rio.

Adicionar Rate Limit para login/registro.

Melhorar seguranÃ§a: expiraÃ§Ã£o curta do token e refresh token.

- Falta fazer para estar 100%

Revisar dependÃªncias (token.js pode ser removido).

- 3. Busca de usuÃ¡rios
Na rota /users, hoje qualquer usuÃ¡rio autenticado pode buscar todos os outros.
Se nÃ£o houver controle, isso vira risco de privacidade.
ğŸ’¡ SugestÃ£o:

Implementar paginaÃ§Ã£o e filtros.

Permitir busca por nome ou e-mail, mas nÃ£o retornar senhas ou dados sensÃ­veis.











































ğŸ—ï¸ Arquitetura Atual da API
1ï¸âƒ£ Arquivo Principal â€“ server.js

Configura o Express, CORS e carrega variÃ¡veis de ambiente (dotenv).

Conecta ao banco (connectDB).

Registra as rotas:

/auth â†’ rotas de usuÃ¡rios (registro, login, CRUD do prÃ³prio usuÃ¡rio)

/products â†’ rotas de produtos

Middleware de autenticaÃ§Ã£o global (requireAuth) aplicado para rotas privadas.

Endpoint de teste (GET /) para confirmar que a API estÃ¡ rodando.

2ï¸âƒ£ MÃ³dulos e Pastas

ğŸ“‚ controllers/

userControllers.js â†’ login, registro, update de e-mail/senha com envio de token, confirmaÃ§Ã£o de alteraÃ§Ã£o, exclusÃ£o de conta com senha.

productControllers.js â†’ CRUD de produtos com suporte a busca com filtros, paginaÃ§Ã£o e ordenaÃ§Ã£o.

ğŸ“‚ routes/

userRoutes.js â†’ define endpoints /auth/...

productRoutes.js â†’ define endpoints /products/...

ğŸ“‚ middlewares/

requireAuth.js â†’ protege rotas privadas.

validateProductSearch.js â†’ valida filtros de busca de produtos.

validateUser.js â†’ valida corpo de requests de usuÃ¡rio com Joi.

ğŸ“‚ validations/

userSchema.js â†’ validaÃ§Ãµes de registro/atualizaÃ§Ã£o de usuÃ¡rio.

searchUserSchema.js â†’ validaÃ§Ãµes para busca de usuÃ¡rios (com paginaÃ§Ã£o, sort, order).

productSearchSchema.js â†’ validaÃ§Ãµes para busca de produtos.

ğŸ“‚ models/

User.js â†’ schema de usuÃ¡rio (com hash de senha e timestamps).

Tec.js â†’ schema de produto.

Token.js â†’ schema de token temporÃ¡rio (cÃ³digo de 6 dÃ­gitos com expiraÃ§Ã£o de 1 minuto).

ğŸ“‚ utils/

sendEmail.js â†’ envio de e-mails (suporte a HTML e texto puro).

emailTemplates.js â†’ templates HTML de e-mail para envio de cÃ³digo de confirmaÃ§Ã£o.

3ï¸âƒ£ Principais Funcionalidades

âœ… AutenticaÃ§Ã£o: login e registro com bcrypt e JWT
âœ… Troca de e-mail e senha com envio de cÃ³digo por e-mail e confirmaÃ§Ã£o antes de aplicar
âœ… ExpiraÃ§Ã£o de token em 1 minuto para mais seguranÃ§a
âœ… ExclusÃ£o de conta exige senha
âœ… CRUD de produtos com:

Filtros (tÃ­tulo, preÃ§o mÃ­nimo/mÃ¡ximo, estoque)

PaginaÃ§Ã£o (page, limit)

OrdenaÃ§Ã£o (sort, order)

âœ… Busca de usuÃ¡rios com paginaÃ§Ã£o, sort/order e regex parcial (name/email)

4ï¸âƒ£ Pontos Fortes

CÃ³digo modular e fÃ¡cil de expandir

Middleware de validaÃ§Ã£o com Joi para padronizar entrada de dados

Tokens expiram sozinhos (seguranÃ§a)

Envio de e-mail usando templates HTML (UX melhor)

5ï¸âƒ£ Melhorias Futuras (SugestÃµes)

ğŸ”¹ Limpeza automÃ¡tica de tokens expirados (job a cada X minutos)
ğŸ”¹ Controle de acesso mais granular (ex.: rota de listar usuÃ¡rios sÃ³ para administradores)
ğŸ”¹ Filtros de data na busca de usuÃ¡rios (por intervalo de criaÃ§Ã£o)
ğŸ”¹ Testes automatizados (Jest ou Supertest para endpoints principais)
ğŸ”¹ Envio de link clicÃ¡vel no e-mail (para confirmar alteraÃ§Ã£o direto pelo frontend)